(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{9123:function(e,t,r){Promise.resolve().then(r.bind(r,4072))},4072:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return H}});var o=r(7437),n=r(2265);function l(){return(0,o.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M4 6h16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,o.jsx)("path",{d:"M4 12h16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,o.jsx)("path",{d:"M4 18h16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})}function i(){return(0,o.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M18 6L6 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,o.jsx)("path",{d:"M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})}function a(e){let{datasets:t,selected:r,onSelect:n,groupName:l}=e;return(0,o.jsxs)("div",{className:"flex h-full flex-col gap-4 p-4 [background:var(--color-bg)]",children:[(0,o.jsx)("div",{className:"text-2xl font-medium text-[color:var(--color-accent)]",children:"DataSets:"}),(0,o.jsx)("div",{className:"flex flex-col gap-3",children:t.map(e=>(0,o.jsxs)("label",{className:"flex cursor-pointer items-start gap-2 rounded-md border border-[color:var(--color-border)] [background:var(--color-card)] px-3 py-2 text-[color:var(--color-text)] hover:border-[color:var(--color-accent)]",children:[(0,o.jsx)("input",{type:"radio",name:l,value:e.key,checked:r===e.key,onChange:()=>n(e.key),className:"mt-1 accent-[color:var(--color-accent)]"}),(0,o.jsxs)("span",{className:"min-w-0",children:[(0,o.jsx)("div",{className:"text-lg font-medium",children:e.label}),(0,o.jsx)("div",{className:"text-m leading-snug text-[color:var(--color-muted)] break-words whitespace-normal",children:e.moniker})]})]},e.key))})]})}function s(e){let{datasets:t,selected:r,onSelect:s}=e,[c,u]=(0,n.useState)(!1);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("aside",{className:"hbc-dataset-sidebar-static h-full w-[15vw] shrink-0 rounded-lg border border-[color:var(--color-border)] [background:var(--color-card)]",children:(0,o.jsx)(a,{datasets:t,selected:r,onSelect:s,groupName:"dataset-static"})}),(0,o.jsxs)("div",{className:"hbc-dataset-sidebar-hamburger",children:[(0,o.jsx)("button",{type:"button","aria-label":"Open dataset menu",onClick:()=>u(!0),className:"inline-flex items-center justify-center rounded-md border border-[color:var(--color-border)] [background:var(--color-bg)] p-2 text-[color:var(--color-text)] hover:border-[color:var(--color-accent)]",children:(0,o.jsx)(l,{})}),c?(0,o.jsxs)("div",{className:"fixed inset-0 z-[60]",children:[(0,o.jsx)("button",{type:"button","aria-label":"Close dataset menu",onClick:()=>u(!1),className:"absolute inset-0 cursor-default bg-black/50"}),(0,o.jsxs)("div",{className:"absolute left-0 top-0 h-full w-[15vw] min-w-[260px] border-r border-[color:var(--color-border)] [background:var(--color-card)]",children:[(0,o.jsx)("div",{className:"flex items-center justify-end border-b border-[color:var(--color-border)] p-3",children:(0,o.jsx)("button",{type:"button","aria-label":"Close",onClick:()=>u(!1),className:"inline-flex items-center justify-center rounded-md border border-[color:var(--color-border)] [background:var(--color-bg)] p-2 text-[color:var(--color-text)] hover:border-[color:var(--color-accent)]",children:(0,o.jsx)(i,{})})}),(0,o.jsx)(a,{datasets:t,selected:r,onSelect:e=>{s(e)},groupName:"dataset-drawer"})]})]}):null]})]})}var c=r(29),u=r.n(c);r(4868),r(8537);var d=r(8280),m=r(891);function f(e){let{rowData:t,columnDefs:r,className:l,height:i="100%",loading:a,error:s,gridOptions:c,rowIdField:d,onGridReady:f,onFilterChanged:p,onSortChanged:h,onSelectionChanged:g,onCellClicked:v,onCellDoubleClicked:b,onCellKeyDown:x,onFilterPaste:_}=e,y=(0,n.useRef)(null),k=(0,n.useMemo)(()=>{let e=new Map;for(let o of null!=r?r:[]){var t;let r=null!==(t=o.colId)&&void 0!==t?t:o.field;r&&e.set(r,o.filter)}return e},[r]);async function j(e){try{var t,r;if(null===(r=navigator)||void 0===r?void 0:null===(t=r.clipboard)||void 0===t?void 0:t.writeText){await navigator.clipboard.writeText(e);return}}catch(e){}let o=document.createElement("textarea");o.value=e,o.setAttribute("readonly","true"),o.style.position="fixed",o.style.top="-9999px",document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o)}function w(e){var t;if(!e||!(e instanceof HTMLElement))return null;let r=null===(t=e.closest("[col-id]"))||void 0===t?void 0:t.getAttribute("col-id");if(r&&r.length)return r;if(!e.closest(".ag-floating-filter"))return null;let o=e.closest(".ag-header-cell"),n=null==o?void 0:o.getAttribute("col-id");return n&&n.length?n:null}function C(e,t){var r,o,n;let l=y.current;if(!l)return;let i=null!==(o=l.getFilterModel())&&void 0!==o?o:{},a=i[e],s="string"==typeof t?t:null==a?void 0:a.filter;if("string"!=typeof s)return;let c=s.trim();if(!c)return;let u=(null==a?void 0:a.type)?String(a.type).toLowerCase():"",d="string"==typeof(null==a?void 0:a.filter)?a.filter.trim():"";("equals"!==u||d!==c)&&(l.setFilterModel({...i,[e]:{...null!=a?a:{},filterType:null!==(n=null==a?void 0:a.filterType)&&void 0!==n?n:"text",type:"equals",filter:c}}),null===(r=l.onFilterChanged)||void 0===r||r.call(l))}function S(e,t){var r,o;let n=y.current;if(!n)return;let l=null!==(o=n.getFilterModel())&&void 0!==o?o:{},i=l[e],a="string"==typeof t?t:null==i?void 0:i.dateFrom;if("string"!=typeof a)return;let s=function(e){let t=e.trim();if(!t)return null;let r=/^(\d{4}-\d{2}-\d{2})/.exec(t);if(r)return r[1];let o=Date.parse(t);if(!Number.isFinite(o))return null;let n=new Date(o),l=String(n.getFullYear()).padStart(4,"0"),i=String(n.getMonth()+1).padStart(2,"0"),a=String(n.getDate()).padStart(2,"0");return"".concat(l,"-").concat(i,"-").concat(a)}(a);if(!s)return;let c=(null==i?void 0:i.type)?String(i.type).toLowerCase():"",u="string"==typeof(null==i?void 0:i.dateFrom)?i.dateFrom.trim():"";("equals"!==c||u!==s)&&(n.setFilterModel({...l,[e]:{...null!=i?i:{},filterType:"date",type:"equals",dateFrom:s}}),null===(r=n.onFilterChanged)||void 0===r||r.call(n))}function N(e){var t;let r=y.current,o=(null!==(t=null==r?void 0:r.getFilterModel())&&void 0!==t?t:{})[e],n="string"==typeof(null==o?void 0:o.filterType)?o.filterType:void 0;if(n)return n;let l=k.get(e);return"agDateColumnFilter"===l?"date":"agNumberColumnFilter"===l?"number":"text"}function M(){var e,t,r,o,n;let l=y.current;if(!l)return null;let i=null===(e=l.getFocusedCell)||void 0===e?void 0:e.call(l);if(!i)return null;let a=null===(t=l.getDisplayedRowAtIndex)||void 0===t?void 0:t.call(l,i.rowIndex),s=null===(o=i.column)||void 0===o?void 0:null===(r=o.getColId)||void 0===r?void 0:r.call(o);if(!a||!s)return null;let c=null===(n=a.data)||void 0===n?void 0:n[s];return null==c?null:"string"==typeof c?c:String(c)}let F=(0,n.useMemo)(()=>{var e;return r&&r.length?r:Object.keys(null!==(e=null==t?void 0:t[0])&&void 0!==e?e:{}).map(e=>({field:e}))},[r,t]),L=(0,n.useMemo)(()=>({resizable:!0,suppressMovable:!1,sortable:!0,unSortIcon:!0,filter:!0,floatingFilter:!0,minWidth:90}),[]),q=(0,n.useMemo)(()=>({theme:"legacy",animateRows:!0,rowSelection:"single",suppressCellFocus:!1,pagination:!1,suppressMovableColumns:!1,alwaysShowHorizontalScroll:!0,suppressHorizontalScroll:!1,suppressRowClickSelection:!0,enableCellTextSelection:!0,ensureDomOrder:!0,...null!=c?c:{}}),[c]),T=["hbc-ag-grid ag-theme-quartz-dark w-full rounded-lg border border-[color:var(--color-border)] bg-[color:var(--color-card)]",l].filter(Boolean).join(" "),D=(0,n.useMemo)(()=>({height:"100%","--ag-border-color":"rgba(255, 255, 255, 0.16)","--ag-secondary-border-color":"rgba(255, 255, 255, 0.12)","--ag-header-column-resize-handle-color":"rgba(255, 255, 255, 0.65)","--ag-header-column-resize-handle-width":"4px","--ag-header-column-resize-handle-height":"60%"}),[]);return(0,o.jsxs)("div",{className:"w-full",style:{height:i},onKeyDownCapture:function(e){var t;let r=null===(t=e.key)||void 0===t?void 0:t.toLowerCase(),o=(e.metaKey||e.ctrlKey)&&"c"===r&&!e.shiftKey&&!e.altKey,n=(e.metaKey||e.ctrlKey)&&"v"===r&&!e.shiftKey&&!e.altKey;if(!o&&!n)return;let l=w(e.target);if(!l){if(o){let t=M();if(!t)return;e.preventDefault(),j(t)}return}if(n){null==_||_(l),window.setTimeout(()=>{let t=e.target,r=t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement?t.value:void 0;if("date"===N(l)){S(l,r);return}C(l,r)},40);return}if(o){let t=M();if(!t)return;e.preventDefault(),j(t)}},onPasteCapture:function(e){let t=w(e.target);t&&(null==_||_(t),window.setTimeout(()=>{let r=e.target,o=r instanceof HTMLInputElement||r instanceof HTMLTextAreaElement?r.value:void 0;if("date"===N(t)){S(t,o);return}C(t,o)},40))},children:[s?(0,o.jsx)("div",{className:"mb-3 rounded-md border border-red-500/40 bg-red-500/10 px-3 py-2 text-sm text-red-200",children:s}):null,(0,o.jsxs)("div",{style:D,className:"jsx-22d5c091a0aa6afd "+(T||""),children:[(0,o.jsx)(u(),{id:"22d5c091a0aa6afd",children:".hbc-ag-grid .ag-header-cell-resize{cursor:col-resize}.hbc-ag-grid .ag-header-cell-resize::after{cursor:col-resize}"}),(0,o.jsx)(m.s,{rowData:t,columnDefs:F,defaultColDef:L,gridOptions:q,loading:a,onGridReady:e=>{y.current=e.api,null==f||f(e)},onFilterChanged:p,onSortChanged:h,onSelectionChanged:g,onCellClicked:v,onCellDoubleClicked:b,onCellKeyDown:function(e){var t;null==x||x(e);let r=e.event;if(!r)return;let o=null===(t=r.key)||void 0===t?void 0:t.toLowerCase();if(!((r.metaKey||r.ctrlKey)&&"c"===o&&!r.shiftKey&&!r.altKey))return;let n=e.value;if(null==n)return;let l="string"==typeof n?n:String(n);r.preventDefault(),j(l)},getRowId:d?e=>{var t;let r=null===(t=e.data)||void 0===t?void 0:t[d];return"string"==typeof r&&r.length?r:"number"==typeof r?String(r):JSON.stringify(e.data)}:void 0})]})]})}function p(){return(0,o.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z",stroke:"currentColor",strokeWidth:"2"}),(0,o.jsx)("path",{d:"M12 10v7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,o.jsx)("path",{d:"M12 7h.01",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round"})]})}function h(e){let{title:t="Grid shortcuts",ariaLabel:r="Grid help",widthClassName:n="w-[420px]",items:l}=e;return(0,o.jsxs)("div",{className:"relative inline-flex items-center",children:[(0,o.jsx)("button",{type:"button","aria-label":r,className:"peer inline-flex items-center justify-center rounded-md border border-transparent bg-transparent p-1 text-[color:var(--color-muted)] hover:text-[color:var(--color-text)]",children:(0,o.jsx)(p,{})}),(0,o.jsxs)("div",{className:["pointer-events-none absolute right-full top-full z-20 mr-2 mt-2 hidden rounded-md border border-[color:var(--color-accent)] [background:var(--color-card)] p-3 text-sm text-[color:var(--color-text)] shadow-lg peer-hover:block",n].join(" "),children:[(0,o.jsx)("div",{className:"font-semibold text-[color:var(--color-accent)]",children:t}),(0,o.jsx)("ul",{className:"mt-2 list-disc space-y-1 pl-5 text-[color:var(--color-muted)]",children:l.map(e=>(0,o.jsx)("li",{children:e},e))})]})]})}function g(e){let t=e.trim();if(!t)return null;let r=t.includes(" ")&&!t.includes("T")?t.replace(" ","T"):t;return/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}(:\d{2}(\.\d{1,3})?)?(Z|[+-]\d{2}:\d{2})?$/.test(r)?r:null}function v(e){let t=/^(\d{4}-\d{2}-\d{2})/.exec(e);if(t)return t[1];let r=Date.parse(e);if(!Number.isFinite(r))return null;let o=new Date(r),n=String(o.getUTCFullYear()).padStart(4,"0"),l=String(o.getUTCMonth()+1).padStart(2,"0"),i=String(o.getUTCDate()).padStart(2,"0");return"".concat(n,"-").concat(l,"-").concat(i)}function b(e){if(null==e)return"";if(e instanceof Date&&Number.isFinite(e.getTime())){let t=e.toISOString();return"".concat(t.slice(0,10)," ").concat(t.slice(11,19))}let t=String(e).trim();if(!t)return"";let r=g(t);if(!r)return t;let o=r.slice(0,10),n=r.includes("T")?r.slice(11,19):"";return n?"".concat(o," ").concat(n):o}function x(e){return e.replace(/'/g,"''")}function _(e,t,r){let o="".concat(r,"T00:00:00"),n=Date.parse("".concat(r,"T00:00:00Z"));if(Number.isFinite(n)){let r=new Date(n+864e5),l=String(r.getUTCFullYear()).padStart(4,"0"),i=String(r.getUTCMonth()+1).padStart(2,"0"),a=String(r.getUTCDate()).padStart(2,"0"),s="".concat(l,"-").concat(i,"-").concat(a,"T00:00:00");e.push("(".concat(t," ge '").concat(o,"' and ").concat(t," lt '").concat(s,"')"))}else e.push("".concat(t," eq '").concat(o,"'"))}function y(){return(0,o.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M14 5h5v5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,o.jsx)("path",{d:"M10 14L19 5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,o.jsx)("path",{d:"M19 14v5H5V5h5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}function k(e){let{title:t,table:r,docUrl:l,rowIdField:i,buildColumnDefs:a,parseRows:s,pageSize:c=50,dateFields:u,dateTimeFields:d,helpItems:m=["Single click focuses a cell; copy with Cmd+C (macOS) or Ctrl+C (Windows/Linux).","Double click a cell to toggle selecting its entire row.","Press Esc to clear all column filters.","Use the X button to clear any selected rows (de-select all).","Use the filter-reset button to clear all column filters.","Pagination buttons move between pages (first/prev/next/last); filters affect server-side results and paging."]}=e,[p,b]=(0,n.useState)(1),[k,j]=(0,n.useState)({}),[w,C]=(0,n.useState)(void 0),[S,N]=(0,n.useState)(void 0),M=(0,n.useRef)(null),F=(0,n.useRef)(!1),L=(0,n.useMemo)(()=>new Set((null!=u?u:[]).map(e=>e.trim()).filter(Boolean)),[u]),q=(0,n.useMemo)(()=>new Set((null!=d?d:[]).map(e=>e.trim()).filter(Boolean)),[d]),T=(0,n.useRef)(null),[D,O]=(0,n.useState)(0),R=(0,n.useMemo)(()=>a(F),[a]),[W,I]=(0,n.useState)(!1),[z,E]=(0,n.useState)({rows:[],invalidCount:0,issues:[]});(0,n.useEffect)(()=>{let e=new AbortController;return async function(){let t=(p-1)*c,o=new URLSearchParams;o.set("$top",String(c)),o.set("$skip",String(t)),o.set("$count","true"),w&&o.set("$filter",w);let n="".concat("/backend","/").concat(r,"?").concat(o.toString());I(!0);try{let t=await fetch(n,{cache:"no-store",signal:e.signal});if(!t.ok){E({rows:[],invalidCount:0,issues:[],error:"REST API error ".concat(t.status," on GET ").concat(n)});return}let r=await t.json(),o="object"==typeof r&&null!==r&&"value"in r?r.value:r,l=s(o),i="object"==typeof r&&null!==r&&"count"in r&&"number"==typeof r.count?r.count:void 0;E({...l,totalCount:i})}catch(t){if(e.signal.aborted)return;E({rows:[],invalidCount:0,issues:[],error:"Failed to fetch: ".concat(t instanceof Error?t.message:String(t))})}finally{e.signal.aborted||I(!1)}}(),()=>e.abort()},[p,w,c,s,r]),(0,n.useEffect)(()=>{W||(F.current=!1)},[W]);let{rows:K,invalidCount:P,issues:U,error:B,totalCount:A}=z,Z=p>1,G=K.length===c&&("number"!=typeof A||p*c<A),Y="number"==typeof A?Math.max(1,Math.ceil(A/c)):void 0,H="number"==typeof Y&&p<Y,$=!!w||Object.keys(k).length>0,X=(0,n.useCallback)(()=>{var e;let t=T.current;t&&(t.setFilterModel(null),null===(e=t.onFilterChanged)||void 0===e||e.call(t),j({}),C(void 0),N(void 0),b(1))},[]);return(0,n.useEffect)(()=>{function e(e){"Escape"!==e.key||e.ctrlKey||e.metaKey||e.altKey||!$||X()}return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[X,$]),(0,o.jsxs)("div",{className:"flex h-full min-h-0 min-w-0 flex-col rounded-lg border border-[color:var(--color-border)] [background:var(--color-bg)] p-6 text-[color:var(--color-text)]",children:[(0,o.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,o.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,o.jsxs)("div",{className:"flex min-w-0 items-center gap-2",children:[(0,o.jsx)("h1",{className:"min-w-0 text-xl font-medium text-[color:var(--color-accent)]",children:t}),(0,o.jsx)("a",{href:l,target:"_blank",rel:"noopener noreferrer","aria-label":"Open dataset docs in new window",className:"inline-flex shrink-0 items-center justify-center rounded-md border border-transparent p-1.5 text-[color:var(--color-muted)] hover:border-[color:var(--color-border)] hover:text-[color:var(--color-accent)]",title:"Open in new window",children:(0,o.jsx)(y,{})})]}),(0,o.jsxs)("div",{className:"flex shrink-0 items-center gap-2",children:[(0,o.jsx)("button",{type:"button",onClick:function(){var e,t,r,o,n;let l=T.current;if(!l)return;let i=(null!==(n=null!==(o=null==l?void 0:null===(e=l.getAllGridColumns)||void 0===e?void 0:e.call(l))&&void 0!==o?o:null==l?void 0:null===(t=l.getAllColumns)||void 0===t?void 0:t.call(l))&&void 0!==n?n:[]).map(e=>{var t,r,o,n,l,i;let a=null===(t=e.getColId)||void 0===t?void 0:t.call(e),s=null!==(o=null===(r=e.getColDef)||void 0===r?void 0:r.call(e))&&void 0!==o?o:{},c=String(null!==(i=null!==(l=null!==(n=s.headerName)&&void 0!==n?n:s.field)&&void 0!==l?l:a)&&void 0!==i?i:"");return a?{key:a,newWidth:Math.max(140,Math.min(900,Math.ceil(9*c.length+80)))}:null}).filter(Boolean);null==l||null===(r=l.setColumnWidths)||void 0===r||r.call(l,i,!0)},className:"inline-flex shrink-0 items-center justify-center rounded-md border border-transparent px-2 py-1 text-sm text-[color:var(--color-muted)] hover:border-[color:var(--color-border)] hover:text-[color:var(--color-accent)]",title:"Fit columns to header",children:"Fit Columns"}),(0,o.jsx)("button",{type:"button",onClick:function(){var e,t,r,o,n;let l=T.current;if(!l)return;let i=(null!==(n=null!==(o=null==l?void 0:null===(e=l.getAllGridColumns)||void 0===e?void 0:e.call(l))&&void 0!==o?o:null==l?void 0:null===(t=l.getAllColumns)||void 0===t?void 0:t.call(l))&&void 0!==n?n:[]).map(e=>{var t;return null===(t=e.getColId)||void 0===t?void 0:t.call(e)}).filter(Boolean);null==l||null===(r=l.autoSizeColumns)||void 0===r||r.call(l,i,!0)},className:"inline-flex shrink-0 items-center justify-center rounded-md border border-transparent px-2 py-1 text-sm text-[color:var(--color-muted)] hover:border-[color:var(--color-border)] hover:text-[color:var(--color-accent)]",title:"Auto-size columns to content",children:"Fit Data"}),(0,o.jsx)(h,{items:m})]})]}),U.length?(0,o.jsxs)("div",{className:"rounded-md border border-yellow-500/30 bg-yellow-500/10 px-3 py-2 text-sm text-yellow-100",children:[(0,o.jsx)("div",{className:"font-medium",children:"Validation issues (sample)"}),(0,o.jsx)("ul",{className:"list-disc pl-5",children:U.map(e=>(0,o.jsx)("li",{children:e},e))})]}):null]}),(0,o.jsxs)("div",{className:"mt-4 flex min-h-0 flex-1 flex-col",children:[(0,o.jsx)("div",{className:"min-h-0 flex-1",children:(0,o.jsx)(f,{rowData:K,columnDefs:R,error:null!=B?B:null,rowIdField:i,height:"100%",loading:W,onGridReady:e=>{T.current=e.api},onSelectionChanged:e=>{O(e.api.getSelectedNodes().length)},onFilterPaste:()=>{F.current=!0},onCellDoubleClicked:e=>{e.node&&(e.node.setSelected(!e.node.isSelected()),O(e.api.getSelectedNodes().length))},onFilterChanged:e=>{let t=e.api.getFilterModel();j(t),M.current&&window.clearTimeout(M.current),M.current=window.setTimeout(()=>{let e=function(e,t,r){if(!e)return;let o=[];for(let[n,l]of Object.entries(e)){let e=String(n);if(!l)continue;let i=String(l.type||"").toLowerCase();if(!i||"equals"===i||"contains"===i){if("string"==typeof l.filter){let n=l.filter.trim();if("contains"===i&&n.length<3)continue;let a=x(n);if(!a)continue;if("equals"===i&&((null==t?void 0:t.has(e))||(null==r?void 0:r.has(e)))){let t=g(n);if(t&&(null==r?void 0:r.has(e))){o.push("".concat(e," eq '").concat(x(t),"'"));continue}let l=v(n);l&&_(o,e,l);continue}"contains"===i?o.push("contains(".concat(e,",'").concat(a,"')")):o.push("".concat(e," eq '").concat(a,"'"));continue}if("number"==typeof l.filter&&Number.isFinite(l.filter)){o.push("".concat(e," eq ").concat(l.filter));continue}if("string"==typeof l.dateFrom&&l.dateFrom.trim()){let t=l.dateFrom.trim(),r=/^(\d{4}-\d{2}-\d{2})/.exec(t);_(o,e,r?r[1]:t);continue}}}return o.length?o.join(" and "):void 0}(t,L.size?L:void 0,q.size?q:void 0);C(e),N(e),b(1)},900)},gridOptions:{rowSelection:{mode:"multiRow",enableSelectionWithoutKeys:!0,enableClickSelection:!1,checkboxes:!1,headerCheckbox:!1}}})}),(0,o.jsxs)("div",{className:"mt-3 flex items-center justify-between gap-3",children:[(0,o.jsx)("div",{className:"text-sm text-[color:var(--color-muted)]",children:(()=>{let e="number"==typeof A?A:void 0,t=e?Math.max(1,Math.ceil(e/c)):void 0,r=(p-1)*c+1,n=(p-1)*c+K.length;return(0,o.jsxs)(o.Fragment,{children:["Page ",p,t?" of ".concat(t):"","; ","Rows: ",K.length?"".concat(r,"-").concat(n):"0",e?"; Total Rows ".concat(e):"",P?"; filtered ".concat(P):"",S?"; filter ".concat(S):""]})})()}),(0,o.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,o.jsx)("button",{type:"button","aria-disabled":!Z,disabled:!Z,onClick:()=>b(1),className:["inline-flex items-center justify-center rounded-md border px-2.5 py-2 text-sm","border-[color:var(--color-border)] bg-[color:var(--color-bg)] text-[color:var(--color-text)]",Z?"hover:border-[color:var(--color-accent)]":"opacity-50"].join(" "),title:"First page",children:(0,o.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M18 18l-6-6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,o.jsx)("path",{d:"M12 18l-6-6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),(0,o.jsx)("button",{type:"button","aria-disabled":!Z,disabled:!Z,onClick:()=>b(e=>Math.max(1,e-1)),className:["inline-flex items-center justify-center rounded-md border px-2.5 py-2 text-sm","border-[color:var(--color-border)] bg-[color:var(--color-bg)] text-[color:var(--color-text)]",Z?"hover:border-[color:var(--color-accent)]":"opacity-50"].join(" "),title:"Previous page",children:(0,o.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:(0,o.jsx)("path",{d:"M15 18l-6-6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,o.jsx)("button",{type:"button","aria-disabled":!G,disabled:!G,onClick:()=>b(e=>e+1),className:["inline-flex items-center justify-center rounded-md border px-2.5 py-2 text-sm","border-[color:var(--color-border)] bg-[color:var(--color-bg)] text-[color:var(--color-text)]",G?"hover:border-[color:var(--color-accent)]":"opacity-50"].join(" "),title:"Next page",children:(0,o.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:(0,o.jsx)("path",{d:"M9 6l6 6-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,o.jsx)("button",{type:"button","aria-disabled":!H,disabled:!H,onClick:()=>"number"==typeof Y&&b(Y),className:["inline-flex items-center justify-center rounded-md border px-2.5 py-2 text-sm","border-[color:var(--color-border)] bg-[color:var(--color-bg)] text-[color:var(--color-text)]",H?"hover:border-[color:var(--color-accent)]":"opacity-50"].join(" "),title:"Last page",children:(0,o.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M6 6l6 6-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,o.jsx)("path",{d:"M12 6l6 6-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),(0,o.jsx)("button",{type:"button","aria-disabled":!$,disabled:!$,onClick:X,className:["inline-flex items-center justify-center rounded-md border px-2.5 py-2 text-sm","border-[color:var(--color-border)] bg-[color:var(--color-bg)] text-[color:var(--color-text)]",$?"hover:border-[color:var(--color-accent)]":"opacity-50"].join(" "),title:"Reset filters",children:(0,o.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M4 6h16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,o.jsx)("path",{d:"M7 12h10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,o.jsx)("path",{d:"M10 18h4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),(0,o.jsx)("button",{type:"button","aria-disabled":0===D,disabled:0===D,onClick:function(){var e;null===(e=T.current)||void 0===e||e.deselectAll(),O(0)},className:["inline-flex items-center justify-center rounded-md border px-2.5 py-2 text-sm","border-[color:var(--color-border)] bg-[color:var(--color-bg)] text-[color:var(--color-text)]",D?"hover:border-[color:var(--color-accent)]":"opacity-50"].join(" "),title:D?"Clear selection (".concat(D,")"):"Clear selection",children:(0,o.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M18 6L6 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,o.jsx)("path",{d:"M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})})]})]})]})]})}d.O3h.registerModules([d.ea9]);var j=r(7119);let w=j.Z_().trim().min(1).nullable().optional(),C=j.dj(e=>{if(""===e||null==e||"string"!=typeof e)return null;let t=e.trim();if(!t)return null;let r=Date.parse(t.includes(" ")?t.replace(" ","T"):t);return Number.isNaN(r)?t:new Date(r).toISOString().slice(0,10)},j.Z_().nullable().optional()),S=j.dj(e=>{if(""===e||null==e||"string"!=typeof e)return null;let t=e.trim();if(!t)return null;let r=t.includes(" ")?t.replace(" ","T"):t;return Number.isNaN(Date.parse(r))?t:r},j.Z_().nullable().optional()),N=j.Ry({hbc_unique_key:j.Z_().min(1).optional(),unique_id:w,date:C,time:w,date_time:S,agency:w,agency_name:w,inquiry_name:w,brief_description:w,call_resolution:w}).passthrough(),M=["unique_id","date","time","date_time","agency","agency_name","inquiry_name","brief_description","call_resolution"];function F(e){let t=j.IX(j._4()).safeParse(e);if(!t.success)return{rows:[],invalidCount:0,issues:["Response was not an array of rows."]};let r=[],o=[],n=0;for(let e=0;e<t.data.length;e++){let l=N.safeParse(t.data[e]);if(!l.success){n++,o.length<10&&o.push("Row ".concat(e+1,": ").concat(l.error.issues.map(e=>"".concat(e.path.join(".")||"(root)"," ").concat(e.message)).join("; ")));continue}r.push(l.data)}return n>o.length&&o.push("…and ".concat(n-o.length," more invalid row(s).")),{rows:r,invalidCount:n,issues:o}}function L(e){return M.map(t=>({field:t,filter:"agTextColumnFilter",filterParams:"date"===t?{filterOptions:["equals"],defaultOption:"equals",debounceMs:300,textMatcher:t=>{let{value:r,filterText:o}=t;if(e.current)return!0;let n=(null!=o?o:"").toString().trim();if(!n)return!0;let l=v(n);if(!l)return!0;let i=v((null!=r?r:"").toString());return!i||i===l}}:"date_time"===t?{filterOptions:["equals"],defaultOption:"equals",debounceMs:300,textMatcher:t=>{let{value:r,filterText:o}=t;if(e.current)return!0;let n=(null!=o?o:"").toString().trim();if(!n)return!0;let l=g(n);if(l){let e=g((null!=r?r:"").toString());return!e||e===l}let i=v(n);if(!i)return!0;let a=v((null!=r?r:"").toString());return!a||a===i}}:{filterOptions:["contains","equals"],defaultOption:"contains",debounceMs:150,textMatcher:t=>{let{value:r,filterText:o,filterOption:n}=t;if(e.current)return!0;let l=(null!=r?r:"").toString().toLowerCase(),i=(null!=o?o:"").toString().trim().toLowerCase();return!i||("contains"===n?i.length<4||l.includes(i):"equals"!==n||l===i)}},..."date"===t?{valueFormatter:e=>{let{value:t}=e;return function(e){var t;if(null==e)return"";if(e instanceof Date&&Number.isFinite(e.getTime()))return e.toISOString().slice(0,10);let r=String(e).trim();return r?null!==(t=v(r))&&void 0!==t?t:r:""}(t)}}:{},..."date_time"===t?{valueFormatter:e=>{let{value:t}=e;return b(t)}}:{}}))}function q(e){let{docUrl:t}=e;return(0,o.jsx)(k,{title:"NYC Open Data 311 Call Center Inquiry:",table:"nyc_open_data_311_call_center_inquiry",docUrl:t,dateFields:["date"],dateTimeFields:["date_time"],rowIdField:"hbc_unique_key",buildColumnDefs:L,parseRows:F})}let T=j.Z_().trim().min(1).nullable().optional(),D=j.dj(e=>{if(""===e||null==e)return null;if("number"==typeof e)return Number.isFinite(e)?e:null;if("string"==typeof e){let t=Number(e);return Number.isFinite(t)?t:null}return null},j.Rx().nullable().optional()),O=j.dj(e=>{if(""===e||null==e||"string"!=typeof e)return null;let t=e.trim();if(!t)return null;let r=t.includes(" ")?t.replace(" ","T"):t;return Number.isNaN(Date.parse(r))?t:r},j.Z_().nullable().optional()),R=j.Ry({hbc_unique_key:j.Z_().min(1).optional(),year:T,campaign:T,channel:T,survey_type:T,start_time:O,completion_time:O,survey_language:T,overall_satisfaction:T,wait_time:T,agent_customer_service:T,agent_job_knowledge:T,answer_satisfaction:T,nps:D}).passthrough(),W=["year","campaign","channel","survey_type","start_time","completion_time","survey_language","overall_satisfaction","wait_time","agent_customer_service","agent_job_knowledge","answer_satisfaction","nps"];function I(e){let t=j.IX(j._4()).safeParse(e);if(!t.success)return{rows:[],invalidCount:0,issues:["Response was not an array of rows."]};let r=[],o=[],n=0;for(let e=0;e<t.data.length;e++){let l=R.safeParse(t.data[e]);if(!l.success){n++,o.length<10&&o.push("Row ".concat(e+1,": ").concat(l.error.issues.map(e=>"".concat(e.path.join(".")||"(root)"," ").concat(e.message)).join("; ")));continue}r.push(l.data)}return n>o.length&&o.push("…and ".concat(n-o.length," more invalid row(s).")),{rows:r,invalidCount:n,issues:o}}function z(e){return W.map(t=>({field:t,filter:"nps"===t?"agNumberColumnFilter":"agTextColumnFilter",filterParams:"nps"===t?{filterOptions:["equals"],defaultOption:"equals",debounceMs:300}:"start_time"===t||"completion_time"===t?{filterOptions:["equals"],defaultOption:"equals",debounceMs:300,textMatcher:t=>{let{value:r,filterText:o}=t;if(e.current)return!0;let n=(null!=o?o:"").toString().trim();if(!n)return!0;let l=g(n);if(l){let e=g((null!=r?r:"").toString());return!e||e===l}let i=v(n);if(!i)return!0;let a=v((null!=r?r:"").toString());return!a||a===i}}:{filterOptions:["contains","equals"],defaultOption:"contains",debounceMs:150,textMatcher:t=>{let{value:r,filterText:o,filterOption:n}=t;if(e.current)return!0;let l=(null!=r?r:"").toString().toLowerCase(),i=(null!=o?o:"").toString().trim().toLowerCase();return!i||("contains"===n?i.length<4||l.includes(i):"equals"!==n||l===i)}},..."start_time"===t||"completion_time"===t?{valueFormatter:e=>{let{value:t}=e;return b(t)}}:{}}))}function E(e){let{docUrl:t}=e;return(0,o.jsx)(k,{title:"NYC Open Data 311 Customer Satisfaction Survey:",table:"nyc_open_data_311_customer_satisfaction_survey",docUrl:t,dateTimeFields:["start_time","completion_time"],rowIdField:"hbc_unique_key",buildColumnDefs:z,parseRows:I})}let K=j.Z_().trim().min(1).nullable().optional(),P=j.dj(e=>{if(""===e||null==e)return null;if("number"==typeof e)return Number.isFinite(e)?e:null;if("string"==typeof e){let t=Number(e);return Number.isFinite(t)?t:null}return null},j.Rx().nullable().optional()),U=j.dj(e=>{if(""===e||null==e||"string"!=typeof e)return null;let t=e.trim();if(!t)return null;let r=t.includes(" ")?t.replace(" ","T"):t;return Number.isNaN(Date.parse(r))?t:r},j.Z_().nullable().optional()),B=j.Ry({hbc_unique_key:j.Z_().min(1).optional(),unique_key:K,address_type:K,agency:K,agency_name:K,borough:K,bridge_highway_direction:K,bridge_highway_name:K,bridge_highway_segment:K,city:K,closed_date:U,community_board:K,complaint_type:K,created_date:U,cross_street_1:K,cross_street_2:K,descriptor:K,due_date:U,facility_type:K,ferry_direction:K,ferry_terminal_name:K,garage_lot_name:K,incident_address:K,incident_zip:K,intersection_street_1:K,intersection_street_2:K,landmark:K,latitude:P,location:K,location_type:K,longitude:P,park_borough:K,park_facility_name:K,resolution_action_updated_date:U,road_ramp:K,school_address:K,school_city:K,school_code:K,school_name:K,school_not_found:K,school_number:K,school_or_citywide_complaint:K,school_phone_number:K,school_region:K,school_state:K,school_zip:K,status:K,street_name:K,taxi_company_borough:K,taxi_pick_up_location:K,vehicle_type:K,x_coordinate_state_plane_:P,y_coordinate_state_plane_:P}).passthrough(),A=["address_type","agency","agency_name","borough","bridge_highway_direction","bridge_highway_name","bridge_highway_segment","city","closed_date","community_board","complaint_type","created_date","cross_street_1","cross_street_2","descriptor","due_date","facility_type","ferry_direction","ferry_terminal_name","garage_lot_name","incident_address","incident_zip","intersection_street_1","intersection_street_2","landmark","latitude","location","location_type","longitude","park_borough","park_facility_name","resolution_action_updated_date","road_ramp","school_address","school_city","school_code","school_name","school_not_found","school_number","school_or_citywide_complaint","school_phone_number","school_region","school_state","school_zip","status","street_name","taxi_company_borough","taxi_pick_up_location","unique_key","vehicle_type","x_coordinate_state_plane_","y_coordinate_state_plane_"];function Z(e){let t=j.IX(j._4()).safeParse(e);if(!t.success)return{rows:[],invalidCount:0,issues:["Response was not an array of rows."]};let r=[],o=[],n=0;for(let e=0;e<t.data.length;e++){let l=B.safeParse(t.data[e]);if(!l.success){n++,o.length<10&&o.push("Row ".concat(e+1,": ").concat(l.error.issues.map(e=>"".concat(e.path.join(".")||"(root)"," ").concat(e.message)).join("; ")));continue}r.push(l.data)}return n>o.length&&o.push("…and ".concat(n-o.length," more invalid row(s).")),{rows:r,invalidCount:n,issues:o}}function G(e){return A.map(t=>({field:t,filter:t.includes("date")?"agTextColumnFilter":"latitude"===t||"longitude"===t||t.endsWith("_coordinate_state_plane_")?"agNumberColumnFilter":"agTextColumnFilter",filterParams:t.includes("date")?{filterOptions:["equals"],defaultOption:"equals",debounceMs:300,textMatcher:t=>{let{value:r,filterText:o}=t;if(e.current)return!0;let n=(null!=o?o:"").toString().trim();if(!n)return!0;let l=g(n);if(l){let e=g((null!=r?r:"").toString());return!e||e===l}let i=v(n);if(!i)return!0;let a=v((null!=r?r:"").toString());return!a||a===i}}:"latitude"===t||"longitude"===t||t.endsWith("_coordinate_state_plane_")?{filterOptions:["equals"],defaultOption:"equals",debounceMs:300}:{filterOptions:["contains","equals"],defaultOption:"contains",debounceMs:150,textMatcher:t=>{let{value:r,filterText:o,filterOption:n}=t;if(e.current)return!0;let l=(null!=r?r:"").toString().toLowerCase(),i=(null!=o?o:"").toString().trim().toLowerCase();return!i||("contains"===n?i.length<4||l.includes(i):"equals"!==n||l===i)}},...t.includes("date")?{valueFormatter:e=>{let{value:t}=e;return b(t)}}:{}}))}function Y(e){let{docUrl:t}=e;return(0,o.jsx)(k,{title:"NYC Open Data 311 Service Requests:",table:"nyc_open_data_311_service_requests",docUrl:t,dateTimeFields:A.filter(e=>e.includes("date")),rowIdField:"hbc_unique_key",buildColumnDefs:G,parseRows:Z})}function H(){var e,t,r;let l=(0,n.useMemo)(()=>[{key:"nyc_open_data_311_customer_satisfaction_survey",label:"NYC 311 Customer Satisfaction Survey",docUrl:"https://data.cityofnewyork.us/City-Government/311-Customer-Satisfaction-Survey/kizp-4dfk/about_data",Component:E},{key:"nyc_open_data_311_call_center_inquiry",label:"NYC 311 Call Center Inquiry",docUrl:"https://data.cityofnewyork.us/City-Government/311-Call-Center-Inquiry/wewp-mm3p/about_data",Component:q},{key:"nyc_open_data_311_service_requests",label:"NYC 311 Service Requests",docUrl:"https://data.cityofnewyork.us/Social-Services/311-Service-Requests-for-2009/3rfa-3xsf/about_data",Component:Y}],[]),[i,a]=(0,n.useState)(null!==(t=null===(e=l[0])||void 0===e?void 0:e.key)&&void 0!==t?t:"nyc_open_data_311_service_requests"),c=(0,n.useMemo)(()=>l.map(e=>{let{key:t,label:r}=e;return{key:t,label:r,moniker:t}}),[l]),u=null!==(r=l.find(e=>e.key===i))&&void 0!==r?r:l[0],d=null==u?void 0:u.Component;return(0,o.jsx)("div",{className:"h-full min-h-0 w-full rounded-lg border-0 border-[color:var(--color-accent)] [background:var(--color-bg)] p-3 text-[color:var(--color-text)]",children:(0,o.jsxs)("div",{className:"flex h-full min-h-0 w-full gap-6",children:[(0,o.jsx)(s,{datasets:c,selected:i,onSelect:a}),(0,o.jsx)("div",{className:"min-h-0 min-w-0 flex-1",children:d?(0,o.jsx)(d,{docUrl:u.docUrl}):null})]})})}}},function(e){e.O(0,[292,224,314,818,971,117,744],function(){return e(e.s=9123)}),_N_E=e.O()}]);