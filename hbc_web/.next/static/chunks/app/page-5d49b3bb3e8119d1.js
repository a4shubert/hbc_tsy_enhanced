(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{9123:function(e,t,r){Promise.resolve().then(r.bind(r,9906))},9906:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return $}});var o=r(7437),n=r(2265);function l(){return(0,o.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M4 6h16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,o.jsx)("path",{d:"M4 12h16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,o.jsx)("path",{d:"M4 18h16",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})}function i(){return(0,o.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M18 6L6 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,o.jsx)("path",{d:"M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})}function a(e){let{datasets:t,selected:r,onSelect:n,groupName:l}=e;return(0,o.jsxs)("div",{className:"flex h-full flex-col gap-4 p-4 [background:var(--color-bg)]",children:[(0,o.jsx)("div",{className:"text-2xl font-medium text-[color:var(--color-accent)]",children:"DataSets:"}),(0,o.jsx)("div",{className:"flex flex-col gap-3",children:t.map(e=>(0,o.jsxs)("label",{className:"flex cursor-pointer items-start gap-2 rounded-md border border-[color:var(--color-border)] [background:var(--color-card)] px-3 py-2 text-[color:var(--color-text)] hover:border-[color:var(--color-accent)]",children:[(0,o.jsx)("input",{type:"radio",name:l,value:e.key,checked:r===e.key,onChange:()=>n(e.key),className:"mt-1 accent-[color:var(--color-accent)]"}),(0,o.jsxs)("span",{className:"min-w-0",children:[(0,o.jsx)("div",{className:"text-lg font-medium",children:e.label}),(0,o.jsx)("div",{className:"text-m leading-snug text-[color:var(--color-muted)] break-words whitespace-normal",children:e.moniker})]})]},e.key))})]})}function s(e){let{datasets:t,selected:r,onSelect:s}=e,[c,d]=(0,n.useState)(!1);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("aside",{className:"hbc-dataset-sidebar-static h-full w-[15vw] shrink-0 rounded-lg border border-[color:var(--color-border)] [background:var(--color-card)]",children:(0,o.jsx)(a,{datasets:t,selected:r,onSelect:s,groupName:"dataset-static"})}),(0,o.jsxs)("div",{className:"hbc-dataset-sidebar-hamburger",children:[(0,o.jsx)("button",{type:"button","aria-label":"Open dataset menu",onClick:()=>d(!0),className:"inline-flex items-center justify-center rounded-md border border-[color:var(--color-border)] [background:var(--color-bg)] p-2 text-[color:var(--color-text)] hover:border-[color:var(--color-accent)]",children:(0,o.jsx)(l,{})}),c?(0,o.jsxs)("div",{className:"fixed inset-0 z-[60]",children:[(0,o.jsx)("button",{type:"button","aria-label":"Close dataset menu",onClick:()=>d(!1),className:"absolute inset-0 cursor-default bg-black/50"}),(0,o.jsxs)("div",{className:"absolute left-0 top-0 h-full w-[15vw] min-w-[260px] border-r border-[color:var(--color-border)] [background:var(--color-card)]",children:[(0,o.jsx)("div",{className:"flex items-center justify-end border-b border-[color:var(--color-border)] p-3",children:(0,o.jsx)("button",{type:"button","aria-label":"Close",onClick:()=>d(!1),className:"inline-flex items-center justify-center rounded-md border border-[color:var(--color-border)] [background:var(--color-bg)] p-2 text-[color:var(--color-text)] hover:border-[color:var(--color-accent)]",children:(0,o.jsx)(i,{})})}),(0,o.jsx)(a,{datasets:t,selected:r,onSelect:e=>{s(e)},groupName:"dataset-drawer"})]})]}):null]})]})}r(4868),r(8537);var c=r(8280),d=r(891);function u(e){let{rowData:t,columnDefs:r,className:l,height:i="100%",loading:a,error:s,gridOptions:c,rowIdField:u,onGridReady:h,onFilterChanged:p,onSortChanged:m,onSelectionChanged:f,onCellClicked:b,onCellDoubleClicked:x,onCellKeyDown:g,onFilterPaste:v}=e,y=(0,n.useRef)(null);async function j(e){try{var t,r;if(null===(r=navigator)||void 0===r?void 0:null===(t=r.clipboard)||void 0===t?void 0:t.writeText){await navigator.clipboard.writeText(e);return}}catch(e){}let o=document.createElement("textarea");o.value=e,o.setAttribute("readonly","true"),o.style.position="fixed",o.style.top="-9999px",document.body.appendChild(o),o.select(),document.execCommand("copy"),document.body.removeChild(o)}function _(e){var t;if(!e||!(e instanceof HTMLElement))return null;let r=null===(t=e.closest("[col-id]"))||void 0===t?void 0:t.getAttribute("col-id");if(r&&r.length)return r;if(!e.closest(".ag-floating-filter"))return null;let o=e.closest(".ag-header-cell"),n=null==o?void 0:o.getAttribute("col-id");return n&&n.length?n:null}function k(e,t){var r,o,n;let l=y.current;if(!l)return;let i=null!==(o=l.getFilterModel())&&void 0!==o?o:{},a=i[e],s="string"==typeof t?t:null==a?void 0:a.filter;if("string"!=typeof s)return;let c=s.trim();c&&(null!=a&&a.type&&"equals"===String(a.type).toLowerCase()||(l.setFilterModel({...i,[e]:{...null!=a?a:{},filterType:null!==(n=null==a?void 0:a.filterType)&&void 0!==n?n:"text",type:"equals",filter:c}}),null===(r=l.onFilterChanged)||void 0===r||r.call(l)))}function w(){var e,t,r,o,n;let l=y.current;if(!l)return null;let i=null===(e=l.getFocusedCell)||void 0===e?void 0:e.call(l);if(!i)return null;let a=null===(t=l.getDisplayedRowAtIndex)||void 0===t?void 0:t.call(l,i.rowIndex),s=null===(o=i.column)||void 0===o?void 0:null===(r=o.getColId)||void 0===r?void 0:r.call(o);if(!a||!s)return null;let c=null===(n=a.data)||void 0===n?void 0:n[s];return null==c?null:"string"==typeof c?c:String(c)}let C=(0,n.useMemo)(()=>{var e;return r&&r.length?r:Object.keys(null!==(e=null==t?void 0:t[0])&&void 0!==e?e:{}).map(e=>({field:e}))},[r,t]),N=(0,n.useMemo)(()=>({resizable:!0,sortable:!0,unSortIcon:!0,filter:!0,floatingFilter:!0,minWidth:140}),[]),S=(0,n.useMemo)(()=>({theme:"legacy",animateRows:!0,rowSelection:"single",suppressCellFocus:!1,pagination:!1,alwaysShowHorizontalScroll:!0,suppressHorizontalScroll:!1,suppressRowClickSelection:!0,enableCellTextSelection:!0,ensureDomOrder:!0,...null!=c?c:{}}),[c]),L=["hbc-ag-grid ag-theme-quartz-dark w-full rounded-lg border border-[color:var(--color-border)] bg-[color:var(--color-card)]",l].filter(Boolean).join(" ");return(0,o.jsxs)("div",{className:"w-full",style:{height:i},onKeyDownCapture:function(e){var t,r,o,n;let l=null===(t=e.key)||void 0===t?void 0:t.toLowerCase(),i=(e.metaKey||e.ctrlKey)&&"c"===l&&!e.shiftKey&&!e.altKey,a=(e.metaKey||e.ctrlKey)&&"v"===l&&!e.shiftKey&&!e.altKey,s="enter"===l;if(!i&&!a&&!s)return;let c=_(e.target);if(!c){if(i){let t=w();if(!t)return;e.preventDefault(),j(t)}return}if(s){let t=(null!==(o=null===(r=y.current)||void 0===r?void 0:r.getFilterModel())&&void 0!==o?o:{})[c];"contains"===String(null!==(n=null==t?void 0:t.type)&&void 0!==n?n:"").toLowerCase()&&(e.preventDefault(),k(c));return}if(a){null==v||v(c),window.setTimeout(()=>{let t=e.target;if(!(t instanceof HTMLInputElement)&&!(t instanceof HTMLTextAreaElement)){k(c);return}k(c,t.value)},40);return}if(i){let t=w();if(!t)return;e.preventDefault(),j(t)}},onPasteCapture:function(e){let t=_(e.target);t&&(null==v||v(t),window.setTimeout(()=>{let r=e.target;r instanceof HTMLInputElement||r instanceof HTMLTextAreaElement?k(t,r.value):k(t)},40))},children:[s?(0,o.jsx)("div",{className:"mb-3 rounded-md border border-red-500/40 bg-red-500/10 px-3 py-2 text-sm text-red-200",children:s}):null,(0,o.jsx)("div",{className:L,style:{height:"100%"},children:(0,o.jsx)(d.s,{rowData:t,columnDefs:C,defaultColDef:N,gridOptions:S,loading:a,onGridReady:e=>{y.current=e.api,null==h||h(e)},onFilterChanged:p,onSortChanged:m,onSelectionChanged:f,onCellClicked:b,onCellDoubleClicked:x,onCellKeyDown:function(e){var t;null==g||g(e);let r=e.event;if(!r)return;let o=null===(t=r.key)||void 0===t?void 0:t.toLowerCase();if(!((r.metaKey||r.ctrlKey)&&"c"===o&&!r.shiftKey&&!r.altKey))return;let n=e.value;if(null==n)return;let l="string"==typeof n?n:String(n);r.preventDefault(),j(l)},getRowId:u?e=>{var t;let r=null===(t=e.data)||void 0===t?void 0:t[u];return"string"==typeof r&&r.length?r:"number"==typeof r?String(r):JSON.stringify(e.data)}:void 0})})]})}function h(){return(0,o.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z",stroke:"currentColor",strokeWidth:"2"}),(0,o.jsx)("path",{d:"M12 10v7",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,o.jsx)("path",{d:"M12 7h.01",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round"})]})}function p(e){let{title:t="Grid shortcuts",ariaLabel:r="Grid help",widthClassName:n="w-[420px]",items:l}=e;return(0,o.jsxs)("div",{className:"relative inline-flex items-center",children:[(0,o.jsx)("button",{type:"button","aria-label":r,className:"peer inline-flex items-center justify-center rounded-md border border-[color:var(--color-border)] bg-[color:var(--color-bg)] p-1 text-[color:var(--color-muted)] hover:text-[color:var(--color-text)] hover:border-[color:var(--color-accent)]",children:(0,o.jsx)(h,{})}),(0,o.jsxs)("div",{className:["pointer-events-none absolute left-0 top-full z-20 mt-2 hidden rounded-md border border-[color:var(--color-border)] bg-[color:var(--color-card)] p-3 text-sm text-[color:var(--color-text)] shadow-lg peer-hover:block",n].join(" "),children:[(0,o.jsx)("div",{className:"font-medium text-[color:var(--color-accent)]",children:t}),(0,o.jsx)("ul",{className:"mt-2 list-disc space-y-1 pl-5 text-[color:var(--color-muted)]",children:l.map(e=>(0,o.jsx)("li",{children:e},e))})]})]})}c.O3h.registerModules([c.ea9]);var m=r(7119);let f=m.Z_().trim().min(1).nullable().optional(),b=m.dj(e=>{if(""===e||null==e||"string"!=typeof e)return null;let t=e.trim();return t?(Number.isNaN(Date.parse(t.includes(" ")?t.replace(" ","T"):t)),t):null},m.Z_().nullable().optional()),x=m.Ry({hbc_unique_key:m.Z_().min(1).optional(),unique_id:f,date:b,time:f,date_time:b,agency:f,agency_name:f,inquiry_name:f,brief_description:f,call_resolution:f}).passthrough(),g=["unique_id","date","time","date_time","agency","agency_name","inquiry_name","brief_description","call_resolution"];function v(){return(0,o.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:(0,o.jsx)("path",{d:"M15 18l-6-6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}function y(){return(0,o.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:(0,o.jsx)("path",{d:"M9 6l6 6-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}function j(){return(0,o.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M18 18l-6-6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,o.jsx)("path",{d:"M12 18l-6-6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}function _(){return(0,o.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M6 6l6 6-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,o.jsx)("path",{d:"M12 6l6 6-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}function k(){let[e,t]=(0,n.useState)(1),[r,l]=(0,n.useState)({}),[i,a]=(0,n.useState)(void 0),[s,c]=(0,n.useState)(void 0),d=(0,n.useRef)(null),h=(0,n.useRef)(!1),f=(0,n.useRef)(null),[b,k]=(0,n.useState)(0),w=(0,n.useMemo)(()=>g.map(e=>({field:e,filter:"date"===e||"date_time"===e?"agDateColumnFilter":"agTextColumnFilter",filterParams:"date"===e||"date_time"===e?{filterOptions:["equals"],defaultOption:"equals",debounceMs:300}:{filterOptions:["contains","equals"],defaultOption:"contains",debounceMs:150,textMatcher:e=>{let{value:t,filterText:r,filterOption:o}=e;if(h.current)return!0;let n=(null!=t?t:"").toString().toLowerCase(),l=(null!=r?r:"").toString().trim().toLowerCase();return!l||("contains"===o?l.length<4||n.includes(l):"equals"!==o||n===l)}}})),[]),[C,N]=(0,n.useState)(!1),[S,L]=(0,n.useState)({rows:[],invalidCount:0,issues:[]});(0,n.useEffect)(()=>{let t=new AbortController;return async function(){let r=(e-1)*50,o=new URLSearchParams;o.set("$top",String(50)),o.set("$skip",String(r)),o.set("$count","true"),i&&o.set("$filter",i);let n="".concat("/backend","/").concat("nyc_open_data_311_call_center_inquiry","?").concat(o.toString());N(!0);try{let e=await fetch(n,{cache:"no-store",signal:t.signal});if(!e.ok){L({rows:[],invalidCount:0,issues:[],error:"REST API error ".concat(e.status," on GET ").concat(n)});return}let r=await e.json();console.log("[hbc_web] GET ".concat(n," ->"),r);let o="object"==typeof r&&null!==r&&"value"in r?r.value:r,l=function(e){let t=m.IX(m._4()).safeParse(e);if(!t.success)return{rows:[],invalidCount:0,issues:["Response was not an array of rows."]};let r=[],o=[],n=0;for(let e=0;e<t.data.length;e++){let l=x.safeParse(t.data[e]);if(!l.success){n++,o.length<10&&o.push("Row ".concat(e+1,": ").concat(l.error.issues.map(e=>"".concat(e.path.join(".")||"(root)"," ").concat(e.message)).join("; ")));continue}r.push(l.data)}return n>o.length&&o.push("…and ".concat(n-o.length," more invalid row(s).")),{rows:r,invalidCount:n,issues:o}}(o),i="object"==typeof r&&null!==r&&"count"in r&&"number"==typeof r.count?r.count:void 0;L({...l,totalCount:i})}catch(e){if(t.signal.aborted)return;L({rows:[],invalidCount:0,issues:[],error:"Failed to fetch: ".concat(e instanceof Error?e.message:String(e))})}finally{t.signal.aborted||N(!1)}}(),()=>t.abort()},[e,i]),(0,n.useEffect)(()=>{C||(h.current=!1)},[C]);let{rows:M,invalidCount:F,issues:q,error:W,totalCount:R}=S,T=e>1,O=50===M.length&&("number"!=typeof R||50*e<R),D="number"==typeof R?Math.max(1,Math.ceil(R/50)):void 0,E="number"==typeof D&&e<D,P=!!i||Object.keys(r).length>0;return(0,o.jsxs)("div",{className:"flex h-full min-h-0 min-w-0 flex-col rounded-lg border border-[color:var(--color-border)] bg-[color:var(--color-bg)] p-6 text-[color:var(--color-text)]",children:[(0,o.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[(0,o.jsx)("h1",{className:"text-xl font-medium text-[color:var(--color-accent)]",children:"NYC Open Data 311 Call Center Inquiry:"}),(0,o.jsx)(p,{items:["Single click focuses a cell; copy with Cmd+C (macOS) or Ctrl+C (Windows/Linux).","Double click a cell to toggle selecting its entire row.","After typing in a filter, press Enter to switch from contains → equals.","Use the X button to clear any selected rows (de-select all).","Use the filter-reset button to clear all column filters.","Pagination buttons move between pages (first/prev/next/last); filters affect server-side results and paging."]})]}),q.length?(0,o.jsxs)("div",{className:"rounded-md border border-yellow-500/30 bg-yellow-500/10 px-3 py-2 text-sm text-yellow-100",children:[(0,o.jsx)("div",{className:"font-medium",children:"Validation issues (sample)"}),(0,o.jsx)("ul",{className:"list-disc pl-5",children:q.map(e=>(0,o.jsx)("li",{children:e},e))})]}):null]}),(0,o.jsxs)("div",{className:"mt-4 flex min-h-0 flex-1 flex-col",children:[(0,o.jsx)("div",{className:"min-h-0 flex-1",children:(0,o.jsx)(u,{rowData:M,columnDefs:w,error:null!=W?W:null,rowIdField:"hbc_unique_key",height:"100%",loading:C,onGridReady:e=>{f.current=e.api},onSelectionChanged:e=>{k(e.api.getSelectedNodes().length)},onFilterPaste:()=>{h.current=!0},onCellDoubleClicked:e=>{e.node&&(e.node.setSelected(!e.node.isSelected()),k(e.api.getSelectedNodes().length))},onFilterChanged:e=>{let r=e.api.getFilterModel();l(r),d.current&&window.clearTimeout(d.current),d.current=window.setTimeout(()=>{let e=function(e){if(!e)return;let t=[];for(let[r,o]of Object.entries(e)){let e=String(r);if(!o)continue;let n=String(o.type||"").toLowerCase();if(!n||"equals"===n||"contains"===n){if("string"==typeof o.filter){let r=o.filter.trim();if("contains"===n&&r.length<3)continue;let l=r.replace(/'/g,"''");if(!l)continue;"contains"===n?t.push("contains(".concat(e,",'").concat(l,"')")):t.push("".concat(e," eq '").concat(l,"'"));continue}if("number"==typeof o.filter&&Number.isFinite(o.filter)){t.push("".concat(e," eq ").concat(o.filter));continue}if("string"==typeof o.dateFrom&&o.dateFrom.trim()){let r="".concat(o.dateFrom.trim(),"T00:00:00");t.push("".concat(e," eq '").concat(r,"'"));continue}}}return t.length?t.join(" and "):void 0}(r);a(e),c(e),t(1)},900)},gridOptions:{rowSelection:{mode:"multiRow",enableSelectionWithoutKeys:!0,enableClickSelection:!1,checkboxes:!1,headerCheckbox:!1}}})}),(0,o.jsxs)("div",{className:"mt-3 flex items-center justify-between gap-3",children:[(0,o.jsx)("div",{className:"text-sm text-[color:var(--color-muted)]",children:(()=>{let t="number"==typeof R?R:void 0,r=t?Math.max(1,Math.ceil(t/50)):void 0,n=(e-1)*50+1,l=(e-1)*50+M.length;return(0,o.jsxs)(o.Fragment,{children:["Page ",e,r?" of ".concat(r):"","; ","Rows: ",M.length?"".concat(n,"-").concat(l):"0",t?"; Total Rows ".concat(t):"",F?"; filtered ".concat(F):"",s?"; filter ".concat(s):""]})})()}),(0,o.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,o.jsx)("button",{type:"button","aria-disabled":!T,disabled:!T,onClick:()=>t(1),className:["inline-flex items-center justify-center rounded-md border px-2.5 py-2 text-sm","border-[color:var(--color-border)] bg-[color:var(--color-bg)] text-[color:var(--color-text)]",T?"hover:border-[color:var(--color-accent)]":"opacity-50"].join(" "),title:"First page",children:(0,o.jsx)(j,{})}),(0,o.jsx)("button",{type:"button","aria-disabled":!T,disabled:!T,onClick:()=>t(e=>Math.max(1,e-1)),className:["inline-flex items-center justify-center rounded-md border px-2.5 py-2 text-sm","border-[color:var(--color-border)] bg-[color:var(--color-bg)] text-[color:var(--color-text)]",T?"hover:border-[color:var(--color-accent)]":"opacity-50"].join(" "),title:"Previous page",children:(0,o.jsx)(v,{})}),(0,o.jsx)("button",{type:"button","aria-disabled":!O,disabled:!O,onClick:()=>t(e=>e+1),className:["inline-flex items-center justify-center rounded-md border px-2.5 py-2 text-sm","border-[color:var(--color-border)] bg-[color:var(--color-bg)] text-[color:var(--color-text)]",O?"hover:border-[color:var(--color-accent)]":"opacity-50"].join(" "),title:"Next page",children:(0,o.jsx)(y,{})}),(0,o.jsx)("button",{type:"button","aria-disabled":!E,disabled:!E,onClick:()=>{"number"==typeof D&&t(D)},className:["inline-flex items-center justify-center rounded-md border px-2.5 py-2 text-sm","border-[color:var(--color-border)] bg-[color:var(--color-bg)] text-[color:var(--color-text)]",E?"hover:border-[color:var(--color-accent)]":"opacity-50"].join(" "),title:"number"==typeof D?"Last page (".concat(D,")"):"Last page",children:(0,o.jsx)(_,{})}),(0,o.jsx)("button",{type:"button","aria-disabled":!P,disabled:!P,onClick:()=>{var e;d.current&&(window.clearTimeout(d.current),d.current=null),null===(e=f.current)||void 0===e||e.setFilterModel(null),l({}),a(void 0),c(void 0),t(1)},className:["inline-flex items-center justify-center rounded-md border px-2.5 py-2 text-sm","border-[color:var(--color-border)] bg-[color:var(--color-bg)] text-[color:var(--color-text)]",P?"hover:border-[color:var(--color-accent)]":"opacity-50"].join(" "),title:"Reset filters",children:(0,o.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M3 6h18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,o.jsx)("path",{d:"M6 12h12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,o.jsx)("path",{d:"M10 18h4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})}),(0,o.jsx)("button",{type:"button","aria-disabled":0===b,disabled:0===b,onClick:()=>{var e;null===(e=f.current)||void 0===e||e.deselectAll(),k(0)},className:["inline-flex items-center justify-center rounded-md border px-2.5 py-2 text-sm","border-[color:var(--color-border)] bg-[color:var(--color-bg)] text-[color:var(--color-text)]",b?"hover:border-[color:var(--color-accent)]":"opacity-50"].join(" "),title:b?"Clear selection (".concat(b,")"):"Clear selection",children:(0,o.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M18 6L6 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,o.jsx)("path",{d:"M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})})]})]})]})]})}let w=m.Z_().trim().min(1).nullable().optional(),C=m.dj(e=>{if(""===e||null==e)return null;if("number"==typeof e)return Number.isFinite(e)?e:null;if("string"==typeof e){let t=Number(e);return Number.isFinite(t)?t:null}return null},m.Rx().nullable().optional()),N=m.dj(e=>{if(""===e||null==e||"string"!=typeof e)return null;let t=e.trim();return t?(Number.isNaN(Date.parse(t.includes(" ")?t.replace(" ","T"):t)),t):null},m.Z_().nullable().optional()),S=m.Ry({hbc_unique_key:m.Z_().min(1).optional(),year:w,campaign:w,channel:w,survey_type:w,start_time:N,completion_time:N,survey_language:w,overall_satisfaction:w,wait_time:w,agent_customer_service:w,agent_job_knowledge:w,answer_satisfaction:w,nps:C}).passthrough(),L=["year","campaign","channel","survey_type","start_time","completion_time","survey_language","overall_satisfaction","wait_time","agent_customer_service","agent_job_knowledge","answer_satisfaction","nps"];function M(){return(0,o.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:(0,o.jsx)("path",{d:"M15 18l-6-6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}function F(){return(0,o.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:(0,o.jsx)("path",{d:"M9 6l6 6-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}function q(){return(0,o.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M18 18l-6-6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,o.jsx)("path",{d:"M12 18l-6-6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}function W(){return(0,o.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M6 6l6 6-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,o.jsx)("path",{d:"M12 6l6 6-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}function R(){let[e,t]=(0,n.useState)(1),[r,l]=(0,n.useState)({}),[i,a]=(0,n.useState)(void 0),[s,c]=(0,n.useState)(void 0),d=(0,n.useRef)(null),h=(0,n.useRef)(!1),f=(0,n.useRef)(null),[b,x]=(0,n.useState)(0),g=(0,n.useMemo)(()=>L.map(e=>({field:e,filter:"nps"===e?"agNumberColumnFilter":"start_time"===e||"completion_time"===e?"agDateColumnFilter":"agTextColumnFilter",filterParams:"nps"===e?{filterOptions:["equals"],defaultOption:"equals",debounceMs:300}:"start_time"===e||"completion_time"===e?{filterOptions:["equals"],defaultOption:"equals",debounceMs:300}:{filterOptions:["contains","equals"],defaultOption:"contains",debounceMs:150,textMatcher:e=>{let{value:t,filterText:r,filterOption:o}=e;if(h.current)return!0;let n=(null!=t?t:"").toString().toLowerCase(),l=(null!=r?r:"").toString().trim().toLowerCase();return!l||("contains"===o?l.length<4||n.includes(l):"equals"!==o||n===l)}}})),[]),[v,y]=(0,n.useState)(!1),[j,_]=(0,n.useState)({rows:[],invalidCount:0,issues:[]});(0,n.useEffect)(()=>{let t=new AbortController;return async function(){let r=(e-1)*50,o=new URLSearchParams;o.set("$top",String(50)),o.set("$skip",String(r)),o.set("$count","true"),i&&o.set("$filter",i);let n="".concat("/backend","/").concat("nyc_open_data_311_customer_satisfaction_survey","?").concat(o.toString());y(!0);try{let e=await fetch(n,{cache:"no-store",signal:t.signal});if(!e.ok){_({rows:[],invalidCount:0,issues:[],error:"REST API error ".concat(e.status," on GET ").concat(n)});return}let r=await e.json();console.log("[hbc_web] GET ".concat(n," ->"),r);let o="object"==typeof r&&null!==r&&"value"in r?r.value:r,l=function(e){let t=m.IX(m._4()).safeParse(e);if(!t.success)return{rows:[],invalidCount:0,issues:["Response was not an array of rows."]};let r=[],o=[],n=0;for(let e=0;e<t.data.length;e++){let l=S.safeParse(t.data[e]);if(!l.success){n++,o.length<10&&o.push("Row ".concat(e+1,": ").concat(l.error.issues.map(e=>"".concat(e.path.join(".")||"(root)"," ").concat(e.message)).join("; ")));continue}r.push(l.data)}return n>o.length&&o.push("…and ".concat(n-o.length," more invalid row(s).")),{rows:r,invalidCount:n,issues:o}}(o),i="object"==typeof r&&null!==r&&"count"in r&&"number"==typeof r.count?r.count:void 0;_({...l,totalCount:i})}catch(e){if(t.signal.aborted)return;_({rows:[],invalidCount:0,issues:[],error:"Failed to fetch: ".concat(e instanceof Error?e.message:String(e))})}finally{t.signal.aborted||y(!1)}}(),()=>t.abort()},[e,i]),(0,n.useEffect)(()=>{v||(h.current=!1)},[v]);let{rows:k,invalidCount:w,issues:C,error:N,totalCount:R}=j,T=e>1,O=50===k.length&&("number"!=typeof R||50*e<R),D="number"==typeof R?Math.max(1,Math.ceil(R/50)):void 0,E="number"==typeof D&&e<D,P=!!i||Object.keys(r).length>0;return(0,o.jsxs)("div",{className:"flex h-full min-h-0 min-w-0 flex-col rounded-lg border border-[color:var(--color-border)] bg-[color:var(--color-bg)] p-6 text-[color:var(--color-text)]",children:[(0,o.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[(0,o.jsx)("h1",{className:"text-xl font-medium text-[color:var(--color-accent)]",children:"NYC Open Data 311 Customer Satisfaction Survey:"}),(0,o.jsx)(p,{items:["Single click focuses a cell; copy with Cmd+C (macOS) or Ctrl+C (Windows/Linux).","Double click a cell to toggle selecting its entire row.","After typing in a filter, press Enter to switch from contains → equals.","Use the X button to clear any selected rows (de-select all).","Use the filter-reset button to clear all column filters.","Pagination buttons move between pages (first/prev/next/last); filters affect server-side results and paging."]})]}),C.length?(0,o.jsxs)("div",{className:"rounded-md border border-yellow-500/30 bg-yellow-500/10 px-3 py-2 text-sm text-yellow-100",children:[(0,o.jsx)("div",{className:"font-medium",children:"Validation issues (sample)"}),(0,o.jsx)("ul",{className:"list-disc pl-5",children:C.map(e=>(0,o.jsx)("li",{children:e},e))})]}):null]}),(0,o.jsxs)("div",{className:"mt-4 flex min-h-0 flex-1 flex-col",children:[(0,o.jsx)("div",{className:"min-h-0 flex-1",children:(0,o.jsx)(u,{rowData:k,columnDefs:g,error:null!=N?N:null,rowIdField:"hbc_unique_key",height:"100%",loading:v,onGridReady:e=>{f.current=e.api},onSelectionChanged:e=>{x(e.api.getSelectedNodes().length)},onFilterPaste:()=>{h.current=!0},onCellDoubleClicked:e=>{e.node&&(e.node.setSelected(!e.node.isSelected()),x(e.api.getSelectedNodes().length))},onFilterChanged:e=>{let r=e.api.getFilterModel();l(r),d.current&&window.clearTimeout(d.current),d.current=window.setTimeout(()=>{let e=function(e){if(!e)return;let t=[];for(let[r,o]of Object.entries(e)){let e=String(r);if(!o)continue;let n=String(o.type||"").toLowerCase();if(!n||"equals"===n||"contains"===n){if("string"==typeof o.filter){let r=o.filter.trim();if("contains"===n&&r.length<3)continue;let l=r.replace(/'/g,"''");if(!l)continue;"contains"===n?t.push("contains(".concat(e,",'").concat(l,"')")):t.push("".concat(e," eq '").concat(l,"'"));continue}if("number"==typeof o.filter&&Number.isFinite(o.filter)){t.push("".concat(e," eq ").concat(o.filter));continue}if("string"==typeof o.dateFrom&&o.dateFrom.trim()){let r="".concat(o.dateFrom.trim(),"T00:00:00");t.push("".concat(e," eq '").concat(r,"'"));continue}}}return t.length?t.join(" and "):void 0}(r);a(e),c(e),t(1)},900)},gridOptions:{rowSelection:{mode:"multiRow",enableSelectionWithoutKeys:!0,enableClickSelection:!1,checkboxes:!1,headerCheckbox:!1}}})}),(0,o.jsxs)("div",{className:"mt-3 flex items-center justify-between gap-3",children:[(0,o.jsx)("div",{className:"text-sm text-[color:var(--color-muted)]",children:(()=>{let t="number"==typeof R?R:void 0,r=t?Math.max(1,Math.ceil(t/50)):void 0,n=(e-1)*50+1,l=(e-1)*50+k.length;return(0,o.jsxs)(o.Fragment,{children:["Page ",e,r?" of ".concat(r):"","; ","Rows: ",k.length?"".concat(n,"-").concat(l):"0",t?"; Total Rows ".concat(t):"",w?"; filtered ".concat(w):"",s?"; filter ".concat(s):""]})})()}),(0,o.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,o.jsx)("button",{type:"button","aria-disabled":!T,disabled:!T,onClick:()=>t(1),className:["inline-flex items-center justify-center rounded-md border px-2.5 py-2 text-sm","border-[color:var(--color-border)] bg-[color:var(--color-bg)] text-[color:var(--color-text)]",T?"hover:border-[color:var(--color-accent)]":"opacity-50"].join(" "),title:"First page",children:(0,o.jsx)(q,{})}),(0,o.jsx)("button",{type:"button","aria-disabled":!T,disabled:!T,onClick:()=>t(e=>Math.max(1,e-1)),className:["inline-flex items-center justify-center rounded-md border px-2.5 py-2 text-sm","border-[color:var(--color-border)] bg-[color:var(--color-bg)] text-[color:var(--color-text)]",T?"hover:border-[color:var(--color-accent)]":"opacity-50"].join(" "),title:"Previous page",children:(0,o.jsx)(M,{})}),(0,o.jsx)("button",{type:"button","aria-disabled":!O,disabled:!O,onClick:()=>t(e=>e+1),className:["inline-flex items-center justify-center rounded-md border px-2.5 py-2 text-sm","border-[color:var(--color-border)] bg-[color:var(--color-bg)] text-[color:var(--color-text)]",O?"hover:border-[color:var(--color-accent)]":"opacity-50"].join(" "),title:"Next page",children:(0,o.jsx)(F,{})}),(0,o.jsx)("button",{type:"button","aria-disabled":!E,disabled:!E,onClick:()=>{"number"==typeof D&&t(D)},className:["inline-flex items-center justify-center rounded-md border px-2.5 py-2 text-sm","border-[color:var(--color-border)] bg-[color:var(--color-bg)] text-[color:var(--color-text)]",E?"hover:border-[color:var(--color-accent)]":"opacity-50"].join(" "),title:"number"==typeof D?"Last page (".concat(D,")"):"Last page",children:(0,o.jsx)(W,{})}),(0,o.jsx)("button",{type:"button","aria-disabled":!P,disabled:!P,onClick:()=>{var e;d.current&&(window.clearTimeout(d.current),d.current=null),null===(e=f.current)||void 0===e||e.setFilterModel(null),l({}),a(void 0),c(void 0),t(1)},className:["inline-flex items-center justify-center rounded-md border px-2.5 py-2 text-sm","border-[color:var(--color-border)] bg-[color:var(--color-bg)] text-[color:var(--color-text)]",P?"hover:border-[color:var(--color-accent)]":"opacity-50"].join(" "),title:"Reset filters",children:(0,o.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M3 6h18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,o.jsx)("path",{d:"M6 12h12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,o.jsx)("path",{d:"M10 18h4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})}),(0,o.jsx)("button",{type:"button","aria-disabled":0===b,disabled:0===b,onClick:()=>{var e;null===(e=f.current)||void 0===e||e.deselectAll(),x(0)},className:["inline-flex items-center justify-center rounded-md border px-2.5 py-2 text-sm","border-[color:var(--color-border)] bg-[color:var(--color-bg)] text-[color:var(--color-text)]",b?"hover:border-[color:var(--color-accent)]":"opacity-50"].join(" "),title:b?"Clear selection (".concat(b,")"):"Clear selection",children:(0,o.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M18 6L6 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,o.jsx)("path",{d:"M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})})]})]})]})]})}let T=m.Z_().trim().min(1).nullable().optional(),O=m.dj(e=>{if(""===e||null==e)return null;if("number"==typeof e)return Number.isFinite(e)?e:null;if("string"==typeof e){let t=Number(e);return Number.isFinite(t)?t:null}return null},m.Rx().nullable().optional()),D=m.dj(e=>{if(""===e||null==e||"string"!=typeof e)return null;let t=e.trim();return t?(Number.isNaN(Date.parse(t.includes(" ")?t.replace(" ","T"):t)),t):null},m.Z_().nullable().optional()),E=m.Ry({hbc_unique_key:m.Z_().min(1).optional(),unique_key:T,address_type:T,agency:T,agency_name:T,borough:T,bridge_highway_direction:T,bridge_highway_name:T,bridge_highway_segment:T,city:T,closed_date:D,community_board:T,complaint_type:T,created_date:D,cross_street_1:T,cross_street_2:T,descriptor:T,due_date:D,facility_type:T,ferry_direction:T,ferry_terminal_name:T,garage_lot_name:T,incident_address:T,incident_zip:T,intersection_street_1:T,intersection_street_2:T,landmark:T,latitude:O,location:T,location_type:T,longitude:O,park_borough:T,park_facility_name:T,resolution_action_updated_date:D,road_ramp:T,school_address:T,school_city:T,school_code:T,school_name:T,school_not_found:T,school_number:T,school_or_citywide_complaint:T,school_phone_number:T,school_region:T,school_state:T,school_zip:T,status:T,street_name:T,taxi_company_borough:T,taxi_pick_up_location:T,vehicle_type:T,x_coordinate_state_plane_:O,y_coordinate_state_plane_:O}).passthrough(),P=["address_type","agency","agency_name","borough","bridge_highway_direction","bridge_highway_name","bridge_highway_segment","city","closed_date","community_board","complaint_type","created_date","cross_street_1","cross_street_2","descriptor","due_date","facility_type","ferry_direction","ferry_terminal_name","garage_lot_name","incident_address","incident_zip","intersection_street_1","intersection_street_2","landmark","latitude","location","location_type","longitude","park_borough","park_facility_name","resolution_action_updated_date","road_ramp","school_address","school_city","school_code","school_name","school_not_found","school_number","school_or_citywide_complaint","school_phone_number","school_region","school_state","school_zip","status","street_name","taxi_company_borough","taxi_pick_up_location","unique_key","vehicle_type","x_coordinate_state_plane_","y_coordinate_state_plane_"];function B(){return(0,o.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:(0,o.jsx)("path",{d:"M15 18l-6-6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}function A(){return(0,o.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:(0,o.jsx)("path",{d:"M9 6l6 6-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}function I(){return(0,o.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M18 18l-6-6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,o.jsx)("path",{d:"M12 18l-6-6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}function K(){return(0,o.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M6 6l6 6-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,o.jsx)("path",{d:"M12 6l6 6-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}function G(){let[e,t]=(0,n.useState)(1),[r,l]=(0,n.useState)({}),[i,a]=(0,n.useState)(void 0),[s,c]=(0,n.useState)(void 0),d=(0,n.useRef)(null),h=(0,n.useRef)(!1),f=(0,n.useRef)(null),[b,x]=(0,n.useState)(0),g=(0,n.useMemo)(()=>P.map(e=>({field:e,filter:e.includes("date")?"agDateColumnFilter":"latitude"===e||"longitude"===e||e.endsWith("_coordinate_state_plane_")?"agNumberColumnFilter":"agTextColumnFilter",filterParams:e.includes("date")?{filterOptions:["equals"],defaultOption:"equals",debounceMs:300}:"latitude"===e||"longitude"===e||e.endsWith("_coordinate_state_plane_")?{filterOptions:["equals"],defaultOption:"equals",debounceMs:300}:{filterOptions:["contains","equals"],defaultOption:"contains",debounceMs:150,textMatcher:e=>{let{value:t,filterText:r,filterOption:o}=e;if(h.current)return!0;let n=(null!=t?t:"").toString().toLowerCase(),l=(null!=r?r:"").toString().trim().toLowerCase();return!l||("contains"===o?l.length<4||n.includes(l):"equals"!==o||n===l)}}})),[]),[v,y]=(0,n.useState)(!1),[j,_]=(0,n.useState)({rows:[],invalidCount:0,issues:[]});(0,n.useEffect)(()=>{let t=new AbortController;return async function(){let r=(e-1)*50,o=new URLSearchParams;o.set("$top",String(50)),o.set("$skip",String(r)),o.set("$count","true"),i&&o.set("$filter",i);let n="".concat("/backend","/").concat("nyc_open_data_311_service_requests","?").concat(o.toString());y(!0);try{let e=await fetch(n,{cache:"no-store",signal:t.signal});if(!e.ok){_({rows:[],invalidCount:0,issues:[],error:"REST API error ".concat(e.status," on GET ").concat(n)});return}let r=await e.json();console.log("[hbc_web] GET ".concat(n," ->"),r);let o="object"==typeof r&&null!==r&&"value"in r?r.value:r,l=function(e){let t=m.IX(m._4()).safeParse(e);if(!t.success)return{rows:[],invalidCount:0,issues:["Response was not an array of rows."]};let r=[],o=[],n=0;for(let e=0;e<t.data.length;e++){let l=E.safeParse(t.data[e]);if(!l.success){n++,o.length<10&&o.push("Row ".concat(e+1,": ").concat(l.error.issues.map(e=>"".concat(e.path.join(".")||"(root)"," ").concat(e.message)).join("; ")));continue}r.push(l.data)}return n>o.length&&o.push("…and ".concat(n-o.length," more invalid row(s).")),{rows:r,invalidCount:n,issues:o}}(o),i="object"==typeof r&&null!==r&&"count"in r&&"number"==typeof r.count?r.count:void 0;_({...l,totalCount:i})}catch(e){if(t.signal.aborted)return;_({rows:[],invalidCount:0,issues:[],error:"Failed to fetch: ".concat(e instanceof Error?e.message:String(e))})}finally{t.signal.aborted||y(!1)}}(),()=>t.abort()},[e,i]),(0,n.useEffect)(()=>{v||(h.current=!1)},[v]);let{rows:k,invalidCount:w,issues:C,error:N,totalCount:S}=j,L=e>1,M=50===k.length&&("number"!=typeof S||50*e<S),F="number"==typeof S?Math.max(1,Math.ceil(S/50)):void 0,q="number"==typeof F&&e<F,W=!!i||Object.keys(r).length>0;return(0,o.jsxs)("div",{className:"flex h-full min-h-0 min-w-0 flex-col rounded-lg border border-[color:var(--color-border)] bg-[color:var(--color-bg)] p-6 text-[color:var(--color-text)]",children:[(0,o.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[(0,o.jsx)("h1",{className:"text-xl font-medium text-[color:var(--color-accent)]",children:"NYC Open Data 311 Service Requests:"}),(0,o.jsx)(p,{items:["Single click focuses a cell; copy with Cmd+C (macOS) or Ctrl+C (Windows/Linux).","Double click a cell to toggle selecting its entire row.","After typing in a filter, press Enter to switch from contains → equals.","Use the X button to clear any selected rows (de-select all).","Use the filter-reset button to clear all column filters.","Pagination buttons move between pages (first/prev/next/last); filters affect server-side results and paging."]})]}),C.length?(0,o.jsxs)("div",{className:"rounded-md border border-yellow-500/30 bg-yellow-500/10 px-3 py-2 text-sm text-yellow-100",children:[(0,o.jsx)("div",{className:"font-medium",children:"Validation issues (sample)"}),(0,o.jsx)("ul",{className:"list-disc pl-5",children:C.map(e=>(0,o.jsx)("li",{children:e},e))})]}):null]}),(0,o.jsxs)("div",{className:"mt-4 flex min-h-0 flex-1 flex-col",children:[(0,o.jsx)("div",{className:"min-h-0 flex-1",children:(0,o.jsx)(u,{rowData:k,columnDefs:g,error:null!=N?N:null,rowIdField:"hbc_unique_key",height:"100%",loading:v,onGridReady:e=>{f.current=e.api},onSelectionChanged:e=>{x(e.api.getSelectedNodes().length)},onFilterPaste:()=>{h.current=!0},onCellDoubleClicked:e=>{e.node&&(e.node.setSelected(!e.node.isSelected()),x(e.api.getSelectedNodes().length))},onFilterChanged:e=>{let r=e.api.getFilterModel();l(r),d.current&&window.clearTimeout(d.current),d.current=window.setTimeout(()=>{let e=function(e){if(!e)return;let t=[];for(let[r,o]of Object.entries(e)){let e=String(r);if(!o)continue;let n=String(o.type||"").toLowerCase();if(!n||"equals"===n||"contains"===n){if("string"==typeof o.filter){let r=o.filter.trim();if("contains"===n&&r.length<3)continue;let l=r.replace(/'/g,"''");if(!l)continue;"contains"===n?t.push("contains(".concat(e,",'").concat(l,"')")):t.push("".concat(e," eq '").concat(l,"'"));continue}if("number"==typeof o.filter&&Number.isFinite(o.filter)){t.push("".concat(e," eq ").concat(o.filter));continue}if("string"==typeof o.dateFrom&&o.dateFrom.trim()){let r="".concat(o.dateFrom.trim(),"T00:00:00");t.push("".concat(e," eq '").concat(r,"'"));continue}}}return t.length?t.join(" and "):void 0}(r);a(e),c(e),t(1)},900)},gridOptions:{rowSelection:{mode:"multiRow",enableSelectionWithoutKeys:!0,enableClickSelection:!1,checkboxes:!1,headerCheckbox:!1}}})}),(0,o.jsxs)("div",{className:"mt-3 flex items-center justify-between gap-3",children:[(0,o.jsx)("div",{className:"text-sm text-[color:var(--color-muted)]",children:(()=>{let t="number"==typeof S?S:void 0,r=t?Math.max(1,Math.ceil(t/50)):void 0,n=(e-1)*50+1,l=(e-1)*50+k.length;return(0,o.jsxs)(o.Fragment,{children:["Page ",e,r?" of ".concat(r):"","; ","Rows: ",k.length?"".concat(n,"-").concat(l):"0",t?"; Total Rows ".concat(t):"",w?"; filtered ".concat(w):"",s?"; filter ".concat(s):""]})})()}),(0,o.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,o.jsx)("button",{type:"button","aria-disabled":!L,disabled:!L,onClick:()=>t(1),className:["inline-flex items-center justify-center rounded-md border px-2.5 py-2 text-sm","border-[color:var(--color-border)] bg-[color:var(--color-bg)] text-[color:var(--color-text)]",L?"hover:border-[color:var(--color-accent)]":"opacity-50"].join(" "),title:"First page",children:(0,o.jsx)(I,{})}),(0,o.jsx)("button",{type:"button","aria-disabled":!L,disabled:!L,onClick:()=>t(e=>Math.max(1,e-1)),className:["inline-flex items-center justify-center rounded-md border px-2.5 py-2 text-sm","border-[color:var(--color-border)] bg-[color:var(--color-bg)] text-[color:var(--color-text)]",L?"hover:border-[color:var(--color-accent)]":"opacity-50"].join(" "),title:"Previous page",children:(0,o.jsx)(B,{})}),(0,o.jsx)("button",{type:"button","aria-disabled":!M,disabled:!M,onClick:()=>t(e=>e+1),className:["inline-flex items-center justify-center rounded-md border px-2.5 py-2 text-sm","border-[color:var(--color-border)] bg-[color:var(--color-bg)] text-[color:var(--color-text)]",M?"hover:border-[color:var(--color-accent)]":"opacity-50"].join(" "),title:"Next page",children:(0,o.jsx)(A,{})}),(0,o.jsx)("button",{type:"button","aria-disabled":!q,disabled:!q,onClick:()=>{"number"==typeof F&&t(F)},className:["inline-flex items-center justify-center rounded-md border px-2.5 py-2 text-sm","border-[color:var(--color-border)] bg-[color:var(--color-bg)] text-[color:var(--color-text)]",q?"hover:border-[color:var(--color-accent)]":"opacity-50"].join(" "),title:"number"==typeof F?"Last page (".concat(F,")"):"Last page",children:(0,o.jsx)(K,{})}),(0,o.jsx)("button",{type:"button","aria-disabled":!W,disabled:!W,onClick:()=>{var e;d.current&&(window.clearTimeout(d.current),d.current=null),null===(e=f.current)||void 0===e||e.setFilterModel(null),l({}),a(void 0),c(void 0),t(1)},className:["inline-flex items-center justify-center rounded-md border px-2.5 py-2 text-sm","border-[color:var(--color-border)] bg-[color:var(--color-bg)] text-[color:var(--color-text)]",W?"hover:border-[color:var(--color-accent)]":"opacity-50"].join(" "),title:"Reset filters",children:(0,o.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M3 6h18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,o.jsx)("path",{d:"M6 12h12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,o.jsx)("path",{d:"M10 18h4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})}),(0,o.jsx)("button",{type:"button","aria-disabled":0===b,disabled:0===b,onClick:()=>{var e;null===(e=f.current)||void 0===e||e.deselectAll(),x(0)},className:["inline-flex items-center justify-center rounded-md border px-2.5 py-2 text-sm","border-[color:var(--color-border)] bg-[color:var(--color-bg)] text-[color:var(--color-text)]",b?"hover:border-[color:var(--color-accent)]":"opacity-50"].join(" "),title:b?"Clear selection (".concat(b,")"):"Clear selection",children:(0,o.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none","aria-hidden":"true",children:[(0,o.jsx)("path",{d:"M18 6L6 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,o.jsx)("path",{d:"M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})})]})]})]})]})}function $(){var e,t,r;let l=(0,n.useMemo)(()=>[{key:"nyc_open_data_311_service_requests",label:"NYC 311 Service Requests",render:()=>(0,o.jsx)(G,{})},{key:"nyc_open_data_311_customer_satisfaction_survey",label:"NYC 311 Customer Satisfaction Survey",render:()=>(0,o.jsx)(R,{})},{key:"nyc_open_data_311_call_center_inquiry",label:"NYC 311 Call Center Inquiry",render:()=>(0,o.jsx)(k,{})}],[]),[i,a]=(0,n.useState)(null!==(t=null===(e=l[0])||void 0===e?void 0:e.key)&&void 0!==t?t:"nyc_open_data_311_service_requests"),c=(0,n.useMemo)(()=>l.map(e=>{let{key:t,label:r}=e;return{key:t,label:r,moniker:t}}),[l]),d=null!==(r=l.find(e=>e.key===i))&&void 0!==r?r:l[0];return(0,o.jsx)("div",{className:"h-full min-h-0 w-full rounded-lg border-0 border-[color:var(--color-accent)] [background:var(--color-bg)] p-3 text-[color:var(--color-text)]",children:(0,o.jsxs)("div",{className:"flex h-full min-h-0 w-full gap-6",children:[(0,o.jsx)(s,{datasets:c,selected:i,onSelect:a}),(0,o.jsx)("div",{className:"min-h-0 min-w-0 flex-1",children:null==d?void 0:d.render()})]})})}}},function(e){e.O(0,[292,224,314,610,971,117,744],function(){return e(e.s=9123)}),_N_E=e.O()}]);